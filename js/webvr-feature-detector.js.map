{"version":3,"sources":["node_modules\\browser-pack\\_prelude.js","src\\webvr-feature-detector.js"],"names":["window","load","batches","callback","progressFn","failFn","runScriptBatch","batchScript","console","log","scriptLength","i","length","scr","clear_","poly","self","results","name","script","document","createElement","s","type","charset","async","src","path","undefined","onreadystatechange","this","readyState","test","scriptCount","firstState","children","err_","e","srcElement","baseURI","onload","onerror","target","head","insertBefore","firstChild","batchCount","getElementsByTagName","documentElement","batchLength","gScriptCount","scriptsToLoad","msg","removeChild","parseInt","len","j","len2","reDetect","retests","error","tests","detect","deviceorientation","eventSupport_","devicemotion","cs","ctx","names","XMLHttpRequest","overrideMimeType","prototype","getComputedStyle","styles","pre","Array","slice","call","join","match","js","css","a","innerHTML","res","CanvasRenderingContext2D","getContext","getParameter","vers","VERSION","toLowerCase","Worker","File","FileReader","FileList","Blob","mod","localStorage","setItem","removeItem","querySelectorAll","CustomEvent","elem","eventName","isSupported","setAttribute","removeAttribute","Object","DocumentTouch","navigator","getGamepads","ua","userAgent","indexOf","re","RegExp","exec","$1","parseFloat","x","substring","WebVRFeatureDetector"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/*\r\n * Device and feature detector for WebVR projects needing to provide\r\n * graceful decay for old and obsolete browsers.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the 'License');\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an 'AS IS' BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\n(function (window) {\r\n  var self = this; // Scope.\r\n  var cs, ctx, tests = [], retests = {}; self.results = {};\r\n\r\n  var names = ['3d', 'webgl', 'experimental-webgl', 'experimental-webgl2', 'moz-webgl'];\r\n\r\n  /*\r\n   * Patches and fixes.\r\n   *\r\n   * This hack lets IE10 render to canvas with newer versions of\r\n   * of THREE.js which use overrideMimeType in the Object loader.\r\n   */\r\n  if(window.XMLHttpRequest) {\r\n    if (!XMLHttpRequest.overrideMimeType) {\r\n      XMLHttpRequest.prototype.overrideMimeType = function (type) {};\r\n    }\r\n  }\r\n\r\n  /* \r\n   * Remove errors for console.log or console.error on ancient browsers.\r\n   * Add 'alert' if debugging desired.\r\n   */\r\n  if (!window.console) {\r\n    window.console = function () {\r\n      return {\r\n        log: function () {},\r\n        error: function () {}\r\n      };\r\n    }\r\n  }\r\n\r\n  /*\r\n   * Feature detection.\r\n   *\r\n   * Our feature detectors are wrapped in named functions so they\r\n   * can be re-tested after loading polyfills.\r\n   *\r\n   * Client vendor prefixes.\r\n   * @link https://davidwalsh.name/vendor-prefix\r\n   */\r\n  tests['vendorPrefix'] = function () {\r\n    // Get the vendor prefix for the client.\r\n    if (!window.getComputedStyle) {\r\n      return {\r\n        js: '',\r\n        css: ''\r\n      };\r\n    } else {\r\n    var styles = window.getComputedStyle(document.documentElement, ''),\r\n    pre = (Array.prototype.slice\r\n        .call(styles)\r\n        .join('')\r\n        .match(/-(moz|webkit|ms|o|xv)-/) || ['',''])[1]; // Default to nothing.\r\n      return {\r\n          js: pre,\r\n          css: '-' + pre + '-',\r\n        };\r\n    }\r\n  };\r\n\r\n  /*\r\n   * Test for document.createElement presence,\r\n   * missing in IE < 7, FF < 2.\r\n   */\r\n  tests['createElement'] = function () {\r\n    return !!(document.createElement);\r\n  };\r\n\r\n  /*\r\n   * Test for basic HTML5 tag support.\r\n   * Adapted from HTML5Shiv\r\n   * @link https://github.com/aFarkas/html5shiv/blob/master/dist/html5shiv.js\r\n   */\r\n  tests['html5'] = function () {\r\n    if(tests['createElement']()) {\r\n      var a = document.createElement('a');\r\n      a.innerHTML = '<xyz></xyz>';\r\n      //if the hidden property is implemented we can assume, that the browser supports basic HTML5 Styles\r\n      var res = ('hidden' in a);\r\n      a = a.innerHTML = null;\r\n      return res;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  /*\r\n   * Test for HTML5 canvas.\r\n   * Note: No compatible polyfill (Flash-based ones won't work for WebVR).\r\n   */\r\n  tests['canvas'] = function () {\r\n    return !!window.CanvasRenderingContext2D;\r\n  };\r\n\r\n  /*\r\n   * Test for WebGL support in browsers supporting HTML5 canvas.\r\n   * IE 9, 10 Polyfill available (non-Flash).\r\n   * @link https://github.com/iewebgl/iewebgl\r\n   */\r\n  tests['webGL'] = function () {\r\n    if (tests['canvas']() && document.createElement) {\r\n        cs = document.createElement('canvas');\r\n        for (i in names) {\r\n          try {\r\n            ctx = cs.getContext(names[i]);\r\n            if (ctx && typeof ctx.getParameter == 'function') {\r\n              cs = ctx = null;\r\n              return true;\r\n            }\r\n          } catch (e) {}\r\n        }\r\n    }\r\n    cs = ctx = null;\r\n    return false;\r\n  };\r\n\r\n  /*\r\n   * It is easier to re-create the WebGL context when\r\n   * extraction version data, instead of trying to add it\r\n   * to tests[] array.\r\n   */\r\n  tests['glVersion'] = function () {\r\n    if (tests['canvas']() && document.createElement) {\r\n        cs = document.createElement('canvas');\r\n        for (i in names) {\r\n          try {\r\n            ctx = cs.getContext(names[i]);\r\n            if (ctx && typeof ctx.getParameter == 'function') {\r\n              var vers = ctx.getParameter(ctx.VERSION).toLowerCase();\r\n              cs = ctx = null;\r\n              return vers;\r\n            }\r\n          } catch (e) {}\r\n        }\r\n    }\r\n    cs = ctx = null;\r\n    return false;\r\n  };\r\n\r\n  /*\r\n   * Detect Promise object support, missing in\r\n   * all IE, Chrome < 33, FF < 29, Safari < 7.1,\r\n   * iOS < 8, Android < 4.4.4.\r\n   */\r\n  tests['promise'] = function () {\r\n    return ('Promise' in window);\r\n  };\r\n\r\n  /*\r\n   * Detect support for WebWorkers, used in many 3D libraries, missing in\r\n   * IE < 11, FF < 3.5, Safari < 4, iOS < 5.1, Android < 4.4.\r\n   */\r\n  tests['workers'] = function () {\r\n    return !!window.Worker;\r\n  };\r\n\r\n  /*\r\n   * Detect FileAPI support, may be usefulf or object\r\n   * management in VR spaces, missing in\r\n   * IE < 10, Chrome < 38, FF < 28, Safari < 5.1, iOS < 6,\r\n   * Android < 3\r\n   */\r\n  tests['fileapi'] = function () {\r\n    return !!(window.File && window.FileReader && window.FileList && window.Blob);\r\n  };\r\n\r\n  /*\r\n  * Detect localStorage support, may be useful for object\r\n  * management in VR spaces, not supported in\r\n  * IE < 8, FF < 3.5, Safari < 4.\r\n  */\r\n  tests['localStorage'] = function () {\r\n    var mod = 'test';\r\n      try {\r\n           localStorage.setItem(mod, mod);\r\n           localStorage.removeItem(mod);\r\n           return true;\r\n       } catch(e) {\r\n           return false;\r\n       }\r\n   };\r\n\r\n   /*\r\n    * Detect fetch (alternative to XHR) API support, better for\r\n    * dynamic object requests than Ajax, missing in\r\n    * All IE, Edge < 14, Chrome < 42, FF < 39, All Safari,\r\n    * Android < 5.6.\r\n    */\r\n  tests['fetch'] = function () {\r\n    return ('fetch' in window);\r\n  };\r\n\r\n  /*\r\n   * Detect support for .querySelectorAll, missing in\r\n   * IE < 9, FF < 3.5\r\n   */\r\n  tests['querySelectorAll'] = function () {\r\n    return !!document.querySelectorAll;\r\n  };\r\n\r\n  /*\r\n   * Detect support for addEventListener, missing in\r\n   * IE < 9.\r\n   */\r\n  tests['addEventListener'] = function () {\r\n    return ('addEventListener' in window);\r\n  };\r\n\r\n  /*\r\n   * Detect support for CustomEvents, missing in\r\n   * IE 9, 10, 11, Android < 4.4\r\n   */\r\n  tests['CustomEvent'] = function () {\r\n    try {\r\n      new CustomEvent('test');\r\n    } catch(e) {\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  /*\r\n   * Detect support for a specific event type.\r\n   * @link http://perfectionkills.com/detecting-event-support-without-browser-sniffing/\r\n   */\r\n  var eventSupport_ = function(elem, eventName) {\r\n    eventName = 'on' + eventName;\r\n    var isSupported = (eventName in elem);\r\n    if (!isSupported && 'setAttribute' in elem) {\r\n      elem.setAttribute(eventName, 'return;');\r\n      isSupported = typeof elem[eventName] == 'function';\r\n      elem.removeAttribute(eventName);\r\n    }\r\n    return isSupported;\r\n  };\r\n\r\n  /*\r\n   * Support for ES5 properties, missing in\r\n   * IE < 9, Chrome < 23, FF < 21, Safari < 6,\r\n   * Android < 4.4\r\n   */\r\n  tests['defineProperty'] = function () {\r\n    return ('defineProperty' in Object);\r\n  };\r\n\r\n  tests['defineProperties'] = function () {\r\n    return ('defineProperties' in Object);\r\n  };\r\n\r\n  /*\r\n   * Detect typed arrays (needed for WebGL), missing in\r\n   * IE < 11, Chrome < 7, FF < 4, Safari < 6,\r\n   * Android < 4.\r\n   */\r\n  tests['typedArray'] = function () {\r\n    return ('ArrayBuffer' in window);\r\n  };\r\n\r\n  /*\r\n   * Detect support for W3C Fullscreen API. No browser completely\r\n   * and consistently supports the W3C standard. Partial support\r\n   * in IE Edge, Chrome > 14, FF > 9, Safari > 5. NO SUPPORT in\r\n   * Android and iOS Safari browser.\r\n   *\r\n   */\r\n  tests['fullScreen'] = function () {\r\n    return !!(document.documentElement.requestFullscreen);\r\n  };\r\n\r\n  /*\r\n   * Detect touch support.\r\n   * useful for changing the Ui if touch is used, missing in\r\n   * IE, Edge, Chrome < 22, FF, Safari. Full support in iOS\r\n   * Safari and Android.\r\n   */\r\n  tests['touch'] = function () {\r\n    return !!(('ontouchstart' in window) || (window.DocumentTouch && document instanceof DocumentTouch));\r\n  };\r\n\r\n  /*\r\n   * Detect native support for requestAnimationFrame, missing in\r\n   * IE < 11, Chrome < 10, FF < 4, Safari < 6, Android < 4.4\r\n   */\r\n  tests['requestAnimationFrame'] = function () {\r\n    return ('requestAnimationFrame' in window);\r\n  };\r\n\r\n  /*\r\n   * Gamepad API, used by haptic controllers.\r\n   * No IE Support, Chrome < 21, FF < 29, no iOS or\r\n   * Android support. Wii has its own non-W3C version,\r\n   * window.wiiu.gamepad\r\n   */\r\n  tests['gamepad'] = function () {\r\n    return !!navigator.getGamepads;\r\n  };\r\n\r\n  /*\r\n   * Test for WebVR API.\r\n   * @link https://iswebvrready.org/\r\n   */\r\n  tests['webvr'] = function () {\r\n    if ('getVRDisplays' in navigator) {\r\n      console.log('found getVRDisplays');\r\n      return true;\r\n    } else if ('getVRDevices' in navigator || 'mozGetVRDevices' in navigator) {\r\n      console.log('found getVRDevices in navigator (obsolete, in Firefox)');\r\n      return false;\r\n    }\r\n    else {\r\n      return false;\r\n    }\r\n  };\r\n\r\n  /*\r\n   * Test for IE and Edge\r\n   * @link https://codepen.io/gapcode/pen/vEJNZN\r\n   * @returns if IE or Edge, the version number, else false.\r\n   */\r\n  tests['ie'] = function () {\r\n    var ua = window.navigator.userAgent.toLowerCase();\r\n\r\n    // IE 10 or older\r\n    if (ua.indexOf('msie ') >= 0) {\r\n      var re  = new RegExp(\"msie ([0-9]{1,}[\\.0-9]{0,})\");\r\n      if (re.exec(ua) != null)\r\n        console.log(RegExp.$1)\r\n        return parseFloat(RegExp.$1);\r\n    }\r\n    else if (ua.indexOf('trident/') >= 0) {\r\n      // IE 11 => return version number\r\n      var x = ua.indexOf('rv:');\r\n      return parseInt(ua.substring(x + 3, ua.indexOf('.', x)), 10);\r\n    }\r\n    var x = ua.indexOf('edge/');\r\n    if (x >= 0) {\r\n      // Edge (IE 12+) => return version number\r\n      return parseInt(ua.substring(x + 5, ua.indexOf('.', x)), 10);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /*\r\n   * Microloader. Store polyfills to load. Deliberately old-school for maximum browser support.\r\n   * @link https://css-tricks.com/snippets/javascript/async-script-loader-with-callback/\r\n   * @link https://www.nczonline.net/blog/2009/07/28/the-best-way-to-load-external-javascript/\r\n  */\r\n  function load (batches, callback, progressFn, failFn) {\r\n    var head = document.getElementsByTagName('head')[0] || document.documentElement,\r\n    batchLength = 0,\r\n    batchCount = 0,\r\n    scriptLength = 0,\r\n    scriptCount = 0,\r\n    gScriptCount = 0,\r\n    scriptsToLoad = 0;\r\n\r\n    var err_ = function (s, msg) {\r\n      console.log('in err_:' + typeof s + ' ' + msg);\r\n      if (s) {\r\n        head.removeChild(s);\r\n      }\r\n      if(failFn) {\r\n        failFn('error at script #:', batchCount, scriptCount, s);\r\n        s = null;\r\n      }\r\n    };\r\n\r\n    var clear_ = function (s) {\r\n      //clear the event and prevent memory leaks\r\n      console.log('clearing event:' + typeof s)\r\n      if (s) {\r\n      // Progress report.\r\n        gScriptCount++;\r\n        progressFn(parseInt(100 * gScriptCount / scriptsToLoad), s.src);\r\n        console.log(\"CLEARING:\" + s.src)\r\n        head.removeChild(s);\r\n        s.onreadystatechange = s.onload = null;\r\n        s = null;\r\n      }\r\n      // Increment script and possibly batch.\r\n      scriptCount++;\r\n      if (scriptCount >= scriptLength) {\r\n        scriptCount = 0; batchCount++;\r\n        if (batchCount < batchLength) {\r\n          runScriptBatch(batches[batchCount])\r\n        } else {\r\n          console.log(\"ALL DONE\")\r\n          callback();\r\n        }\r\n      }\r\n    };\r\n\r\n    function runScriptBatch (batchScript) {\r\n      console.log('scriptLength:' + scriptLength)\r\n      for (var i = 0; i < batchScript.length; i++) {\r\n        scriptLength = batchScript.length; //NOTE: if done outside for (), incorrect value in old IE.\r\n        var scr = batchScript[i];\r\n        if (!scr) {\r\n          clear_(); //empty script\r\n          break;\r\n        }\r\n        // If we don't need the polyfill, don't load it\r\n        if (scr.poly === true && self.results[scr.name] === true) {\r\n          console.log(\"No polyfill needed:\" + scr.name);\r\n          clear_();\r\n        } else {\r\n          console.log('running batchScript:' + scr.name)\r\n          scr.script = document.createElement('script');\r\n          var s = scr.script;\r\n          s.type = 'text/javascript';\r\n          s.charset = 'utf8';\r\n          s.async = true;\r\n          s.src = scr.path;\r\n          // Old IE version.\r\n          if (s.onreadystatechange !== undefined) {\r\n            s.onreadystatechange = function () {\r\n              console.log('value of scriptLength:' + scriptLength)\r\n              console.log('IE readyState:' + this.readyState + ' for:' + this.src)\r\n              if (/loaded|complete/.test(this.readyState)) {\r\n                  console.log('IE loaded:' + this.src);\r\n                  //head.insertBefore(s, head.firstChild);\r\n                  this.onreadystatechange = null;\r\n                  console.log('scriptCount:' + scriptCount)\r\n                  clear_(this);\r\n\r\n                // IE hack to stop loading\r\n                var firstState = this.readyState;\r\n                this.children;\r\n                if (firstState == 'loaded' && this.readyState == 'loading') {\r\n                  err_(this, 'error in readyState load for:' + e.srcElement.baseURI);\r\n                  this.onreadystatechange = null;\r\n                  clear_(this);\r\n                  return;\r\n                }\r\n              } //loaded or complete\r\n            }\r\n          } else if (s.onload !== undefined) {\r\n            s.onload = function (e) {\r\n              console.log('loaded:' + this.src);\r\n              console.log('scriptCount:' + scriptCount)\r\n              clear_(this);\r\n              return;\r\n            }\r\n            s.onerror = function (e) {\r\n              err_(this, 'error in onload for:' + e.target);\r\n            }\r\n          } else {\r\n          err_(this,'script loading not supported');\r\n          }\r\n\r\n        // Add script to document.head.\r\n        //console.log('self.head is a:' + self.head)\r\n        //TODO: TEST ON OLD IE FOR COMPLETION.\r\n        //TODO: may need to use createNode like below\r\n        //@link http://stackoverflow.com/questions/6946631/dynamically-creating-script-readystate-never-complete\r\n          head.insertBefore(s, head.firstChild);\r\n        } //end of batch[i].name test\r\n      } // end of for () loop\r\n      //We only go here if there's an empty batch!\r\n      if(batchScript.length == 0) {\r\n        failFn('Loader: empty batch [] at index:', batchCount, 0, 0, 'undefined');\r\n      }\r\n    }; // end of function\r\n\r\n    // Main program. Count scripts to load.\r\n    console.log('Loader: starting batches:' + batches.length);\r\n\r\n    // Scripts is an array of arrays\r\n    for (var i = 0, len = batches.length; i < len; i++) {\r\n      for (var j = 0, len2 = batches[i].length; j < len2; j++) {\r\n        var scr = batches[i][j];\r\n        if (!scr) {\r\n          failFn('Loader: missing object (probably trailing comma) for batch index:', i, j, scr);\r\n          //return false;\r\n        } else {\r\n\r\n        // Make sure the necessary data is present.\r\n        if (!scr.name || !scr.path || scr.poly === undefined) {\r\n            if (scr.name) {\r\n              scr = scr.name;\r\n            }\r\n            failFn('Loader: incorrect batch syntax for batch index:', i, j, scr);\r\n            return false;\r\n          }\r\n        if (scr.poly === true) {\r\n          if (!self.results[scr.name]) {\r\n            scriptsToLoad++;\r\n          }\r\n        } else {\r\n          scriptsToLoad++;\r\n        }\r\n      }\r\n      }\r\n    }\r\n\r\n    // Set starting length of batches.\r\n    batchLength = batches.length;\r\n    // Load scripts\r\n    runScriptBatch(batches[batchCount]);\r\n  }; // End of microloader.\r\n\r\n  // Redetect after loading complete\r\n  function reDetect () {\r\n    for (var i in retests) {\r\n      console.log('retesting ' + i);\r\n      if (self.results[i] === undefined) {\r\n        console.error('error retest ' + i + ' not in original results!');\r\n      } else if (!self.results[i]) {\r\n        console.log('checking if polyfill ' + i + ' added functionality to browser');\r\n        self.results[i] = tests[i]();\r\n        if (self.results[i]) {\r\n          console.log('polyfill ' + i + ' added browser functionality');\r\n        } else {\r\n          console.error('polyfill ' + i + ' failed to fix browser!');\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  // Detect features. Export so we can re-detect after polyfills are loaded.\r\n  // tests used by other tests can be pre-computed.\r\n  function detect() {\r\n    self.results = {\r\n      deviceorientation: eventSupport_(window, 'deviceorientation'),\r\n      devicemotion: eventSupport_(window, 'devicemotion'),\r\n      load: load,\r\n      detect: detect,\r\n      reDetect: reDetect\r\n    };\r\n    for (var i in tests) {\r\n      if (typeof(tests[i]) === 'function') { // this allows us to pre-compute some results.\r\n        self.results[i] = tests[i]();\r\n      } else {\r\n        self.results[i] = tests[i];\r\n      }\r\n    };\r\n    return self.results;\r\n  }\r\n\r\n  // Fire first detection and report results.\r\n  window.WebVRFeatureDetector = detect();\r\n\r\n})(window);\r\n"]}